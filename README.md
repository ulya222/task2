# TelecomProd — Система управления производственным циклом узлов связи

Информационная система для автоматизации процессов на предприятии по производству телекоммуникационного оборудования: учёт компонентов, планирование заказов, контроль качества, техническая документация.

## Технологический стек

- **Backend:** ASP.NET Core 8, Entity Framework Core, PostgreSQL
- **Frontend:** WPF (.NET 8), MVVM (CommunityToolkit.Mvvm)
- **API:** REST, Swagger

## Структура проекта

- `Core` — сущности, DbContext
- `Host` — веб-API
- `Shell` — WPF-клиент
- `Scripts` — скрипт инициализации БД
- `_hashgen` — утилита генерации BCrypt-хешей паролей

## Запуск

### 1. База данных

1. Установите PostgreSQL.
2. Создайте базу `telecomprod_db`.
3. Задайте пароль (опционально): `$env:TELECOM_DB_PASSWORD = "ваш_пароль"`.
4. Выполните скрипт `Scripts/Init_TelecomProdDB.sql` в Query Tool (pgAdmin) или через psql.

### 2. API (Host)

```bash
dotnet run --project Host
```

API будет доступен по адресу http://127.0.0.1:5000. Swagger: http://127.0.0.1:5000/swagger

### 3. WPF-клиент (Shell)

```bash
dotnet run --project Shell
```

**Учётные данные по умолчанию:** логин `admin`, пароль `password`.

Дополнительные пользователи: `chief`, `tech`, `store`, `assembler` — пароль тот же.

## Модули

1. **Управление материалами и комплектующими** — компоненты (код TYPE-XXXXX), поставщики, склады, остатки, движение.
2. **Производственные заказы** — BOM, планирование, статусы, учёт времени сборки.
3. **Контроль качества** — тесты, результаты измерений, учёт брака, сертификаты.
4. **Отчётность** — dashboard, KPI, отчёты по производству и качеству.

## Экранные формы

1. **Панель** — статистика, срочные задачи, уведомления о низких остатках.
2. **Компоненты** — таблица, фильтрация, добавление/редактирование, предупреждения о минимальных запасах.
3. **Заказы** — создание, смена статуса, визуализация.
4. **Качество** — тесты, дефекты, сертификаты.
5. **Отчёты** — KPI, экспорт (через Swagger/API).

## Роли

- Администратор (admin)
- Начальник производства (chief)
- Технолог (tech)
- Кладовщик (store)
- Сборщик (assembler)

## Изменение паролей

Для генерации BCrypt-хеша:

```bash
cd _hashgen
dotnet run -- "ваш_новый_пароль"
```

Обновите `PasswordHash` в таблице `User` в БД.

## Дополнительные возможности

- **Графики** — на вкладке «Отчёты» отображается столбчатая диаграмма KPI (заказы сегодня, в производстве, позиции с низким остатком).
- **Штрих-код** — на вкладке «Компоненты» поле «Штрих-код»: введите код компонента (например TYPE-00001) и нажмите Enter для поиска и выделения.
- **Email-уведомления** — кнопка «Email: низкие остатки» на вкладке «Отчёты» отправляет письмо со списком позиций с низким остатком. В `Host/appsettings.json` укажите секцию `Email`: `SmtpHost`, `SmtpPort`, `From`, `To`, при необходимости `User` и `Password`.
- **Тема** — переключатель «Светлая тема» / «Тёмная тема» в шапке приложения.

## Переменные окружения

- `TELECOM_DB_PASSWORD` — пароль PostgreSQL (если требуется).
- `TELECOM_HASH_PASSWORD` — для `dotnet run --project Host -- hash` (генерация хеша пароля).
